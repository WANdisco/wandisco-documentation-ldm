(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{168:function(e,t,i){"use strict";i.r(t),i.d(t,"frontMatter",(function(){return o})),i.d(t,"metadata",(function(){return c})),i.d(t,"toc",(function(){return l})),i.d(t,"default",(function(){return b}));var a=i(3),n=i(7),r=(i(0),i(206)),o={id:"migration-verifications",title:"Migration Verifications",sidebar_label:"Migration verifications"},c={unversionedId:"migration-verifications",id:"migration-verifications",isDocsHomePage:!1,title:"Migration Verifications",description:"Migration verifications are currently available as a preview feature. You must enable this feature before you can use it.",source:"@site/docs/migration-verifications.md",slug:"/migration-verifications",permalink:"/wandisco-documentation-ldm/docs/migration-verifications",version:"current",sidebar_label:"Migration verifications",sidebar:"someSidebar",previous:{title:"Backup and Restore",permalink:"/wandisco-documentation-ldm/docs/backup-and-restore"},next:{title:"Troubleshooting",permalink:"/wandisco-documentation-ldm/docs/troubleshooting"}},l=[{value:"Limitations and considerations",id:"limitations-and-considerations",children:[]},{value:"Run a migration verification",id:"run-a-migration-verification",children:[{value:"Override the current verification job",id:"override-the-current-verification-job",children:[]}]},{value:"Show the verification status",id:"show-the-verification-status",children:[{value:"Example status",id:"example-status",children:[]}]},{value:"Verification reports",id:"verification-reports",children:[{value:"Example report",id:"example-report",children:[]}]}],s={toc:l};function b(e){var t=e.components,i=Object(n.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},s,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"Migration verifications are currently available as a preview feature. You must ",Object(r.b)("a",{parentName:"p",href:"./preview-features"},"enable this feature")," before you can use it."),Object(r.b)("p",{parentName:"div"},"This preview version can only be used through the CLI or REST API."))),Object(r.b)("p",null,"LiveData Migrator migrates existing data and ongoing changes to between source and target filesystems, but certain factors may impede this, such as:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Service failures or interruptions."),Object(r.b)("li",{parentName:"ul"},"Software errors or individual file migration failures.")),Object(r.b)("p",null,"Use this feature to scan your source and target filesystems (on a migration path) and compare them for any discrepancies to verify the status of your migration."),Object(r.b)("h2",{id:"limitations-and-considerations"},"Limitations and considerations"),Object(r.b)("p",null,"These are the main aspects and considerations of this feature:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"A migration verification can only be performed on a ",Object(r.b)("a",{parentName:"li",href:"/wandisco-documentation-ldm/docs/manage-migrations#data-migration-states"},"Live, Running or Completed")," data migration."),Object(r.b)("li",{parentName:"ul"},"Only one verification can be active at a time for each data migration."),Object(r.b)("li",{parentName:"ul"},"Verifications are based on the current progress of the migration, and will ignore any paths that are not yet scanned."),Object(r.b)("li",{parentName:"ul"},"For ",Object(r.b)("a",{parentName:"li",href:"/wandisco-documentation-ldm/docs/one-time-migration"},"one-time migrations")," (",Object(r.b)("inlineCode",{parentName:"li"},"--scanOnly"),"), verifications will ignore any client changes."),Object(r.b)("li",{parentName:"ul"},"The verification will ignore any files & directories that have been ",Object(r.b)("a",{parentName:"li",href:"/wandisco-documentation-ldm/docs/configure-exclusions"},"excluded")," from the migration."),Object(r.b)("li",{parentName:"ul"},"The verification will take into account any ",Object(r.b)("a",{parentName:"li",href:"/wandisco-documentation-ldm/docs/create-path-mappings"},"path mappings")," that are applicable to the migration.")),Object(r.b)("h2",{id:"run-a-migration-verification"},"Run a migration verification"),Object(r.b)("p",null,"Add a migration verification for a specified migration by using ",Object(r.b)("a",{parentName:"p",href:"/wandisco-documentation-ldm/docs/command-reference#migration-verification-add"},Object(r.b)("inlineCode",{parentName:"a"},"migration verification add")),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-text",metastring:'title="Example"',title:'"Example"'},"migration verification add --migration-id myMigration\n")),Object(r.b)("h3",{id:"override-the-current-verification-job"},"Override the current verification job"),Object(r.b)("p",null,"Stop the currently running verification job and start a new one by using the ",Object(r.b)("inlineCode",{parentName:"p"},"--override")," parameter."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-text",metastring:'title="Example with override"',title:'"Example',with:!0,'override"':!0},"migration verification add --migration-id myMigration --override\n")),Object(r.b)("h2",{id:"show-the-verification-status"},"Show the verification status"),Object(r.b)("p",null,"Show the verification status to view an ongoing or completed verification job. The verification status will show the number of missing paths and files on the target filesystem and also the number of file size mismatches between the source and target."),Object(r.b)("p",null,"The verification status can be viewed by using:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#migration-verification-show"},Object(r.b)("inlineCode",{parentName:"a"},"migration verification show"))," (for individual verification jobs)"),Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",{parentName:"li",href:"#migration-verification-list"},Object(r.b)("inlineCode",{parentName:"a"},"migration verification list"))," (for all verification jobs)")),Object(r.b)("h3",{id:"example-status"},"Example status"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-text",metastring:'title="Example status of a completed verification"',title:'"Example',status:!0,of:!0,a:!0,completed:!0,'verification"':!0},'{\n  "migrationId" : "testmig",\n  "state" : "COMPLETED",\n  "verificationId" : "e1aedfbd-b094-4a1b-a294-69cdd5a6030a",\n  "verificationPath" : "/testdir",\n  "startTime" : "2021-04-29T13:27:44.278Z",\n  "completeTime" : "2021-04-29T13:27:45.392Z",\n  "verificationEdge" : "/testmig/testdir01/testfile01",\n  "scannerSummary" : {\n    "progressSummary" : {\n      "filesScanned" : 177,\n      "directoriesScanned" : 47,\n      "bytesScanned" : 1105391944,\n      "filesExcluded" : 51,\n      "dirsExcluded" : 0,\n      "bytesExcluded" : 0,\n      "baseScanCompletionTime" : "2021-04-29T13:27:45.392Z"\n    },\n    "contentSummary" : {\n      "byteCount" : 1105391944,\n      "fileCount" : 194,\n      "directoryCount" : 81\n    }\n  },\n  "verificationProgress" : {\n    "matchedPathCount" : 224,\n    "totalFailedPathCount" : 0,\n    "targetFilesMissing" : 0,\n    "targetDirectoriesMissing" : 0,\n    "filesizeMismatches" : 0\n  }\n}\n')),Object(r.b)("h4",{id:"verification-status-values"},"Verification status values"),Object(r.b)("p",null,"The important values to consider are contained within the ",Object(r.b)("inlineCode",{parentName:"p"},"verificationProgress")," output:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"strong"},"matchedPathCount"))," The total number of files and directories that were or have been scanned."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"strong"},"totalFailedPathCount"))," The total number of files and directories that are missing on the target filesystem."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"strong"},"targetFilesMissing"))," The number of files that are missing on the target filesystem."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"strong"},"targetDirectoriesMissing"))," The number of directories that are missing on the target filesystem."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"strong"},"filesizeMismatches"))," The number of files that are mismatched in size between the source and target filesystems.")),Object(r.b)("h2",{id:"verification-reports"},"Verification reports"),Object(r.b)("p",null,"Once a verification job is complete, a verification report will be created in the ",Object(r.b)("inlineCode",{parentName:"p"},"/var/log/wandisco/livedata-migrator")," directory in the format of ",Object(r.b)("inlineCode",{parentName:"p"},"verification-report-{verificationId}-{startTime}.log"),"."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-text",metastring:'"Example verification report file"','"Example':!0,verification:!0,report:!0,'file"':!0},"/var/log/wandisco/livedata-migrator/verification-report-e1aedfbd-b094-4a1b-a294-69cdd5a6030a-1619781713672.log\n")),Object(r.b)("p",null,"This report will contain more details including any paths that have discrepancies."),Object(r.b)("h3",{id:"example-report"},"Example report"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-text",metastring:'title="Example report with errors"',title:'"Example',report:!0,with:!0,'errors"':!0},'2021-04-22 22:44:41.783: Verification job b8264981-c70f-4231-b40e-7b2760afd2b4 is STARTING.  Estimated to scan ScannerContentMatrix{byteCount=20101, fileCount=162, directoryCount=17}\n2021-04-22 22:44:41.817: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_0/4","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481817}\n2021-04-22 22:44:41.821: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_0/8","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481821}\n2021-04-22 22:44:41.821: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_0/1","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481821}\n2021-04-22 22:44:41.821: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_1/6","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481821}\n2021-04-22 22:44:41.825: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_0/7","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481825}\n2021-04-22 22:44:41.827: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_0/0","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481826}\n2021-04-22 22:44:41.827: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/aexcl_0/6","SourceFileLength":100,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481827}\n2021-04-22 22:44:41.879: Verification failure: File not found on target. {"MigrationId":"b8264981-c70f-4231-b40e-7b2760afd2b4","Path":"/repl_test/C8412698_VerificationExclusionTest.b610650c-3496-435d-b1d0-809fbba538ba/mig/dexcl_3/0","SourceFileLength":200,"TargetFileLength":-1,"VerifyResult":"MISSING_ON_TARGET","VerifyTime":1619131481879}\n2021-04-22 22:44:41.901: Verification job b8264981-c70f-4231-b40e-7b2760afd2b4 is COMPLETED.  8 files failed verification from 162\n')))}b.isMDXComponent=!0},206:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return u}));var a=i(0),n=i.n(a);function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t){if(null==e)return{};var i,a,n=function(e,t){if(null==e)return{};var i,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)i=r[a],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)i=r[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var s=n.a.createContext({}),b=function(e){var t=n.a.useContext(s),i=t;return e&&(i="function"==typeof e?e(t):c(c({},t),e)),i},d=function(e){var t=b(e.components);return n.a.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},f=n.a.forwardRef((function(e,t){var i=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=b(i),f=a,u=d["".concat(o,".").concat(f)]||d[f]||m[f]||r;return i?n.a.createElement(u,c(c({ref:t},s),{},{components:i})):n.a.createElement(u,c({ref:t},s))}));function u(e,t){var i=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=i.length,o=new Array(r);o[0]=f;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var s=2;s<r;s++)o[s]=i[s];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,i)}f.displayName="MDXCreateElement"}}]);